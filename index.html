<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>[TITLE]</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

     <style>
        body {
            background-color: #EEEEEE;
            padding-bottom: 40px;
            padding-top: 40px;
        }

        .centre-box {
            margin: 0 auto;
            max-width: 600px;
            padding: 15px;
        }
    </style>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"> </script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"> </script>
    <![endif]-->
</head>
<body>
    <div class="container">
        <div class="centre-box">
            <h1><small>Hello</small></h1>

            <p>
                Welcome to ...
            </p>
        </div>
        <div id="text-block"></div>
        <div id="referrer"></div>
        <a href="https://t.me/share/url?url=t.me/wooky_bird_bot/wookybirdgame?startapp=12345&text=StartGame">share</a>
    </div>

    <script>
        const telegramWebApp = window.Telegram.WebApp;

        telegramWebApp?.ready(function () {
            telegramWebApp.expand();
        });
        let text = "";

        try {
        const userId = telegramWebApp.initDataUnsafe.user.id;
        const username = telegramWebApp.initDataUnsafe.user.username;
        const firstName = telegramWebApp.initDataUnsafe.user.first_name;
        text =  `UserId: ${userId}, UserName: ${username}, First Name: ${firstName}`;
        } catch(ex) {
            text = ex?.message ?? "Error occured";
        }

        const elem = document.getElementById('text-block');
        elem.innerText = text;
        const urlParams = new URLSearchParams(window.location.search);
        const referrer = urlParams.get('tgWebAppStartParam');
        if (referrer) {
            const userId = referrer.split('_')[1];
            const elem = document.getElementById('referrer');
            elem.innerText = 'Referrer UserId: ' + userId;
        }
    </script>
</body>
</html>